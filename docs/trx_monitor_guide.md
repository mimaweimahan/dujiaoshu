# TRXèƒ½é‡ç§Ÿèµè‡ªåŠ¨åŒ–ç›‘å¬ç¨‹åºä½¿ç”¨è¯´æ˜

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

æœ¬ç¨‹åºæ˜¯ä¸€ä¸ª**TRXèƒ½é‡ç§Ÿèµè‡ªåŠ¨åŒ–ç³»ç»Ÿ**ï¼Œç”¨äºï¼š
- âœ… æ¯30ç§’è‡ªåŠ¨æ£€æŸ¥æŒ‡å®šåœ°å€çš„ä½™é¢å’Œäº¤æ˜“
- âœ… å®æ—¶æ˜¾ç¤º TRX ä½™é¢å’Œ USDT ä½™é¢
- âœ… è‡ªåŠ¨æ£€æµ‹æ–°çš„ TRX åˆ°è´¦äº¤æ˜“
- âœ… **æ ¹æ®æ”¶åˆ°çš„TRXé‡‘é¢è‡ªåŠ¨è´­ä¹°å¹¶è½¬å‡ºå¯¹åº”èƒ½é‡ç»™ä»˜æ¬¾äºº**
- âœ… é˜²æ­¢é‡å¤å¤„ç†ï¼ˆå·²å¤„ç†çš„äº¤æ˜“ä¼šè¢«æ ‡è®°ï¼‰
- âœ… ç¾åŒ–çš„æ§åˆ¶å°è¾“å‡ºç•Œé¢
- âœ… å®Œæ•´çš„æ—¥å¿—è®°å½•

## ğŸ¯ ä¸šåŠ¡é€»è¾‘

### èƒ½é‡ç§Ÿèµæµç¨‹

1. **ç”¨æˆ·è½¬è´¦ TRX** â†’ æ‚¨çš„ç›‘å¬åœ°å€
2. **ç¨‹åºæ£€æµ‹åˆ°è´¦** â†’ è‡ªåŠ¨è¯†åˆ«åˆ°è´¦é‡‘é¢
3. **åŒ¹é…èƒ½é‡å¥—é¤** â†’ æ ¹æ®é…ç½®æŸ¥æ‰¾å¯¹åº”çš„èƒ½é‡æ•°é‡
4. **è‡ªåŠ¨è´­ä¹°èƒ½é‡** â†’ è°ƒç”¨ `start_energy_buy()` å‡½æ•°
5. **è½¬ç»™ä»˜æ¬¾äºº** â†’ èƒ½é‡è‡ªåŠ¨è½¬åˆ°ç”¨æˆ·çš„ TRX åœ°å€

### å¥—é¤é…ç½®ç¤ºä¾‹

```json
{
  "1.5": 32000,
  "3": 64000,
  "5": 100000
}
```

**å«ä¹‰**ï¼š
- ç”¨æˆ·è½¬ **1.5 TRX** â†’ è‡ªåŠ¨è½¬ **32,000 èƒ½é‡**ç»™ç”¨æˆ·
- ç”¨æˆ·è½¬ **3 TRX** â†’ è‡ªåŠ¨è½¬ **64,000 èƒ½é‡**ç»™ç”¨æˆ·
- ç”¨æˆ·è½¬ **5 TRX** â†’ è‡ªåŠ¨è½¬ **100,000 èƒ½é‡**ç»™ç”¨æˆ·

---

## âš™ï¸ é…ç½®è¦æ±‚

### å¿…é¡»é…ç½®é¡¹

åœ¨ç³»ç»Ÿè®¾ç½®ä¸­éœ€è¦é…ç½®ä»¥ä¸‹é¡¹ï¼š

| é…ç½®é¡¹ | è¯´æ˜ | ç¤ºä¾‹ |
|-------|------|------|
| `tronscan_api` | Tronscan APIå¯†é’¥ | `xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx` |
| `energy_address` | è¦ç›‘å¬çš„TRXæ”¶æ¬¾åœ°å€ | `TXXXXxxxxXXXXxxxxXXXXxxxxXXXXxxxx` |
| `energy_buy_config` | èƒ½é‡å¥—é¤é…ç½®ï¼ˆJSONæ ¼å¼ï¼‰ | `{"1.5":32000,"3":64000,"5":100000}` |
| `energy_api_token` | èƒ½é‡è´­ä¹°APIçš„Token | å‚è€ƒ `start_energy_buy()` å‡½æ•° |
| `energy_api_secret` | èƒ½é‡è´­ä¹°APIçš„å¯†é’¥ | å‚è€ƒ `start_energy_buy()` å‡½æ•° |

### èƒ½é‡å¥—é¤é…ç½®è¯´æ˜

`energy_buy_config` çš„æ ¼å¼ä¸º JSON å¯¹è±¡ï¼Œæ ¼å¼ï¼š`{"TRXé‡‘é¢": èƒ½é‡æ•°é‡}`

**ç¤ºä¾‹é…ç½®**ï¼š
```json
{
  "1.5": 32000,
  "3": 64000,
  "5": 100000,
  "10": 200000
}
```

**å«ä¹‰**ï¼š
- æ”¶åˆ° `1.5` TRX â†’ è½¬å‡º `32,000` èƒ½é‡
- æ”¶åˆ° `3` TRX â†’ è½¬å‡º `64,000` èƒ½é‡
- æ”¶åˆ° `5` TRX â†’ è½¬å‡º `100,000` èƒ½é‡
- æ”¶åˆ° `10` TRX â†’ è½¬å‡º `200,000` èƒ½é‡

**æ³¨æ„äº‹é¡¹**ï¼š
- âš ï¸ é‡‘é¢å¿…é¡»**ç²¾ç¡®åŒ¹é…**ï¼ˆè¯¯å·®åœ¨0.01ä»¥å†…ï¼‰
- âš ï¸ å¦‚æœæ”¶åˆ°çš„é‡‘é¢ä¸åœ¨é…ç½®ä¸­ï¼Œä¼šè·³è¿‡å¤„ç†å¹¶æ˜¾ç¤ºå¯ç”¨å¥—é¤
- âš ï¸ JSONæ ¼å¼å¿…é¡»æ­£ç¡®ï¼Œå¦åˆ™ä¼šæŠ¥é”™

### å¦‚ä½•è·å– Tronscan APIå¯†é’¥

1. è®¿é—® [Tronscan API](https://tronscan.org/#/api-detail)
2. æ³¨å†Œè´¦å·å¹¶åˆ›å»º API Key
3. å°† API Key é…ç½®åˆ°ç³»ç»Ÿè®¾ç½®ä¸­

---

## ğŸš€ å¯åŠ¨å‘½ä»¤

### åŸºæœ¬å¯åŠ¨

```bash
php artisan listentrx
```

### åå°æŒç»­è¿è¡Œï¼ˆæ¨èï¼‰

```bash
# ä½¿ç”¨ nohup åœ¨åå°è¿è¡Œ
nohup php artisan listentrx > /dev/null 2>&1 &

# æˆ–ä½¿ç”¨ screen
screen -S trx_monitor
php artisan listentrx
# æŒ‰ Ctrl+A ç„¶åæŒ‰ D é€€å‡º screen

# æˆ–ä½¿ç”¨ tmux
tmux new -s trx_monitor
php artisan listentrx
# æŒ‰ Ctrl+B ç„¶åæŒ‰ D é€€å‡º tmux
```

### ä½¿ç”¨ Supervisor ç®¡ç†ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰

åˆ›å»ºé…ç½®æ–‡ä»¶ `/etc/supervisor/conf.d/trx_monitor.conf`ï¼š

```ini
[program:trx_monitor]
process_name=%(program_name)s
command=php /path/to/your/project/artisan listentrx
autostart=true
autorestart=true
user=www-data
numprocs=1
redirect_stderr=true
stdout_logfile=/path/to/your/project/storage/logs/trx_monitor.log
```

ç„¶åå¯åŠ¨ï¼š

```bash
sudo supervisorctl reread
sudo supervisorctl update
sudo supervisorctl start trx_monitor
```

---

## ğŸ“Š æ§åˆ¶å°è¾“å‡ºç¤ºä¾‹

### å¯åŠ¨æ—¶

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         ğŸš€ TRX/USDT æŒç»­ç›‘å¬ç¨‹åºå·²å¯åŠ¨                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ç›‘å¬åœ°å€: TXXXXxxxxXXXXxxxxXXXXxxxxXXXXxxxx
ç›‘å¬é—´éš”: 30ç§’
æŒ‰ Ctrl+C å¯åœæ­¢ç›‘å¬

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“Š ç¬¬ 1 æ¬¡ç›‘å¬æ£€æŸ¥ - 2025-01-01 12:00:00
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ’° æ­£åœ¨è·å–ä½™é¢ä¿¡æ¯...
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’ TRXä½™é¢:            123.456789 TRX  â”‚
â”‚  ğŸ’µ USDTä½™é¢:         1,234.567890 USDT â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ” æ­£åœ¨æ£€æŸ¥æ–°äº¤æ˜“...
ğŸ“‹ å·²è·å–åˆ° 50 æ¡æœ€è¿‘äº¤æ˜“
â° ä¸Šæ¬¡æ£€æŸ¥æ—¶é—´: 2025-01-01 11:59:30
âœ“ æš‚æ— æ–°äº¤æ˜“
âœ… æœ¬æ¬¡æ£€æŸ¥å®Œæˆ

â³ ç­‰å¾…30ç§’åè¿›è¡Œä¸‹ä¸€æ¬¡æ£€æŸ¥...
```

### å‘ç°æ–°äº¤æ˜“æ—¶

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“Š ç¬¬ 5 æ¬¡ç›‘å¬æ£€æŸ¥ - 2025-01-01 12:02:00
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ’° æ­£åœ¨è·å–ä½™é¢ä¿¡æ¯...
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’ TRXä½™é¢:            223.456789 TRX  â”‚
â”‚  ğŸ’µ USDTä½™é¢:         1,234.567890 USDT â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ” æ­£åœ¨æ£€æŸ¥æ–°äº¤æ˜“...
ğŸ“‹ å·²è·å–åˆ° 50 æ¡æœ€è¿‘äº¤æ˜“
â° ä¸Šæ¬¡æ£€æŸ¥æ—¶é—´: 2025-01-01 12:01:30
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ‰ å‘ç° 1 ç¬”æ–°äº¤æ˜“ï¼
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ  ğŸ’° TRXåˆ°è´¦é€šçŸ¥                                   â”ƒ
â”£â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”«
â”ƒ  é‡‘é¢: 100.000000 TRX                             â”ƒ
â”ƒ  å“ˆå¸Œ: 1234567890abcdef1234567890abcdef... â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

ğŸ“ å¼€å§‹å¤„ç†ä¸šåŠ¡é€»è¾‘...

ğŸ“Š äº¤æ˜“è¯¦æƒ…:
  â”œâ”€ ä»˜æ¬¾åœ°å€: TAbcdefgh...rstuvwxyz
  â”œâ”€ æ”¶æ¬¾åœ°å€: TXXXXxxxx...XXXXxxxx
  â”œâ”€ äº¤æ˜“é‡‘é¢: 100.0 TRX
  â”œâ”€ äº¤æ˜“å“ˆå¸Œ: 1234567890ab...cdef1234567890ab
  â””â”€ åŒºå—æ—¶é—´: 2025-01-01 12:01:45

âš™ï¸ æ‰§è¡Œè‡ªå®šä¹‰ä¸šåŠ¡é€»è¾‘...

  [1/2] ğŸ“„ è®°å½•äº¤æ˜“æ—¥å¿—...
        âœ“ æ—¥å¿—è®°å½•æˆåŠŸ
  [2/2] ğŸ”” å‘é€Webhooké€šçŸ¥...
        âœ“ Webhookå‘é€æˆåŠŸ (HTTP 200)

âœ… ä¸šåŠ¡é€»è¾‘å¤„ç†å®Œæˆ

âœ… æœ¬æ¬¡æ£€æŸ¥å®Œæˆ

â³ ç­‰å¾…30ç§’åè¿›è¡Œä¸‹ä¸€æ¬¡æ£€æŸ¥...
```

---

## ğŸ“ æ—¥å¿—æ–‡ä»¶

### äº¤æ˜“æ—¥å¿—æ–‡ä»¶

è‡ªåŠ¨ä¿å­˜åœ¨ï¼š`storage/logs/trx_transactions_YYYY-MM-DD.log`

æ¯è¡Œä¸€æ¡JSONæ ¼å¼çš„äº¤æ˜“è®°å½•ï¼š

```json
{
  "timestamp": "2025-01-01 12:01:50",
  "address": "TXXXXxxxxXXXXxxxxXXXXxxxxXXXXxxxx",
  "amount": 100.0,
  "tx_hash": "1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef",
  "block_timestamp": 1704096105000,
  "from_address": "TAbcdefghijklmnopqrstuvwxyz123456",
  "to_address": "TXXXXxxxxXXXXxxxxXXXXxxxxXXXXxxxx",
  "formatted_time": "2025-01-01 12:01:45"
}
```

### Laravel æ—¥å¿—æ–‡ä»¶

ç³»ç»Ÿæ—¥å¿—ä¿å­˜åœ¨ï¼š`storage/logs/laravel.log`

åŒ…å«æ‰€æœ‰ç›‘å¬è¿‡ç¨‹ä¸­çš„é”™è¯¯ã€è­¦å‘Šå’Œä¿¡æ¯æ—¥å¿—ã€‚

---

## ğŸ”§ å·¥ä½œåŸç†

### ç›‘å¬æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¨‹åºå¯åŠ¨            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŠ è½½é…ç½®            â”‚
â”‚  - APIå¯†é’¥           â”‚
â”‚  - ç›‘å¬åœ°å€          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¿›å…¥æ— é™å¾ªç¯        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. è·å–ä½™é¢         â”‚â—„â”€â”€â”€â”€â”
â”‚     - TRXä½™é¢        â”‚     â”‚
â”‚     - USDTä½™é¢       â”‚     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
           â”‚                 â”‚
           â–¼                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  2. è·å–æœ€æ–°äº¤æ˜“     â”‚     â”‚
â”‚     - æŸ¥è¯¢API        â”‚     â”‚
â”‚     - è¿‡æ»¤æ–°äº¤æ˜“     â”‚     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
           â”‚                 â”‚
           â–¼                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  3. å¤„ç†æ–°äº¤æ˜“       â”‚     â”‚
â”‚     - éªŒè¯äº¤æ˜“       â”‚     â”‚
â”‚     - é˜²é‡å¤å¤„ç†     â”‚     â”‚
â”‚     - æ‰§è¡Œä¸šåŠ¡é€»è¾‘   â”‚     â”‚
â”‚     - è®°å½•æ—¥å¿—       â”‚     â”‚
â”‚     - å‘é€é€šçŸ¥       â”‚     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
           â”‚                 â”‚
           â–¼                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  4. ç­‰å¾…30ç§’         â”‚     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
           â”‚                 â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é˜²é‡å¤æœºåˆ¶

- ä½¿ç”¨ Redis/Cache ç¼“å­˜å·²å¤„ç†çš„äº¤æ˜“å“ˆå¸Œ
- æ¯ä¸ªäº¤æ˜“å“ˆå¸Œç¼“å­˜30å¤©
- æ£€æµ‹åˆ°é‡å¤äº¤æ˜“ä¼šè‡ªåŠ¨è·³è¿‡

### æ—¶é—´æˆ³è¿½è¸ª

- è®°å½•æœ€åæ£€æŸ¥çš„äº¤æ˜“æ—¶é—´æˆ³
- åªå¤„ç†æ—¶é—´æˆ³å¤§äºä¸Šæ¬¡æ£€æŸ¥æ—¶é—´çš„äº¤æ˜“
- ç¼“å­˜7å¤©è‡ªåŠ¨è¿‡æœŸ

---

## ğŸ”” Webhook é€šçŸ¥æ ¼å¼

å¦‚æœé…ç½®äº† `trx_webhook_url`ï¼Œæ¯æ¬¡æ”¶åˆ°æ–°äº¤æ˜“æ—¶ä¼šå‘é€POSTè¯·æ±‚ï¼š

```json
{
  "event": "trx_received",
  "address": "TXXXXxxxxXXXXxxxxXXXXxxxxXXXXxxxx",
  "amount": 100.0,
  "tx_hash": "1234567890abcdef...",
  "timestamp": 1704096105000,
  "from_address": "TAbcdefgh...",
  "to_address": "TXXXXxxxx...",
  "confirmation_time": "2025-01-01 12:01:50",
  "formatted_time": "2025-01-01 12:01:45"
}
```

### Webhook å“åº”è¦æ±‚

- HTTPçŠ¶æ€ç  200 è¡¨ç¤ºæ¥æ”¶æˆåŠŸ
- å…¶ä»–çŠ¶æ€ç ä¼šè¢«è®°å½•ä¸ºè­¦å‘Š

---

## ğŸ¯ è‡ªå®šä¹‰ä¸šåŠ¡é€»è¾‘

åœ¨ `app/Console/Commands/listentrx.php` æ–‡ä»¶çš„ `processBusinessLogic` æ–¹æ³•ä¸­æ·»åŠ æ‚¨çš„ä¸šåŠ¡ä»£ç ï¼š

```php
private function processBusinessLogic($address, $amount, $txHash, $fromAddress, $blockTimestamp)
{
    // ç¤ºä¾‹1: æŸ¥æ‰¾å¹¶æ›´æ–°è®¢å•
    $order = \App\Models\Order::where('trx_address', $fromAddress)
        ->where('amount', $amount)
        ->where('status', 'pending')
        ->first();
    
    if ($order) {
        $order->status = 'paid';
        $order->tx_hash = $txHash;
        $order->save();
        
        $this->info("  âœ“ è®¢å• #{$order->id} å·²æ ‡è®°ä¸ºå·²æ”¯ä»˜");
    }
    
    // ç¤ºä¾‹2: å‘é€é‚®ä»¶é€šçŸ¥
    // Mail::to('admin@example.com')->send(new TrxReceivedMail($amount, $txHash));
    
    // ç¤ºä¾‹3: æ›´æ–°ç”¨æˆ·ä½™é¢
    // $user = User::where('trx_address', $fromAddress)->first();
    // if ($user) {
    //     $user->increment('balance', $amount);
    // }
    
    // æ›´å¤šä¸šåŠ¡é€»è¾‘...
}
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•åœæ­¢ç›‘å¬ç¨‹åºï¼Ÿ

**A:** 
- å¦‚æœåœ¨å‰å°è¿è¡Œï¼šæŒ‰ `Ctrl+C`
- å¦‚æœä½¿ç”¨ screenï¼š`screen -r trx_monitor` ç„¶åæŒ‰ `Ctrl+C`
- å¦‚æœä½¿ç”¨ supervisorï¼š`sudo supervisorctl stop trx_monitor`
- å¦‚æœä½¿ç”¨ nohupï¼š`ps aux | grep listentrx` æ‰¾åˆ°è¿›ç¨‹IDï¼Œç„¶å `kill PID`

### Q2: ä¸ºä»€ä¹ˆè·å–ä¸åˆ°ä½™é¢ï¼Ÿ

**A:** æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
- Tronscan APIå¯†é’¥æ˜¯å¦æ­£ç¡®é…ç½®
- ç›‘å¬åœ°å€æ˜¯å¦æ­£ç¡®
- ç½‘ç»œæ˜¯å¦èƒ½è®¿é—® Tronscan API
- æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ä¸­çš„é”™è¯¯ä¿¡æ¯

### Q3: äº¤æ˜“æ˜æ˜åˆ°è´¦äº†ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰æ£€æµ‹åˆ°ï¼Ÿ

**A:** å¯èƒ½çš„åŸå› ï¼š
- ç›‘å¬ç¨‹åºæœªè¿è¡Œ
- äº¤æ˜“æ—¶é—´æ—©äºç¨‹åºå¯åŠ¨æ—¶é—´ï¼ˆæŸ¥çœ‹"ä¸Šæ¬¡æ£€æŸ¥æ—¶é—´"ï¼‰
- APIè°ƒç”¨å¤±è´¥ï¼ˆæŸ¥çœ‹æ—¥å¿—ï¼‰
- äº¤æ˜“ç±»å‹ä¸æ˜¯ TRX è½¬è´¦ï¼ˆUSDTè½¬è´¦ä¸ä¼šè¢«æ£€æµ‹ï¼‰

### Q4: å¦‚ä½•æŸ¥çœ‹ç¨‹åºè¿è¡ŒçŠ¶æ€ï¼Ÿ

**A:**
```bash
# æŸ¥çœ‹è¿›ç¨‹
ps aux | grep listentrx

# æŸ¥çœ‹æ—¥å¿—ï¼ˆå®æ—¶ï¼‰
tail -f storage/logs/laravel.log

# æŸ¥çœ‹äº¤æ˜“æ—¥å¿—
tail -f storage/logs/trx_transactions_$(date +%Y-%m-%d).log

# å¦‚æœä½¿ç”¨ supervisor
sudo supervisorctl status trx_monitor
```

### Q5: ç›‘å¬é—´éš”å¯ä»¥è°ƒæ•´å—ï¼Ÿ

**A:** å¯ä»¥ï¼åœ¨ `handle()` æ–¹æ³•ä¸­ä¿®æ”¹ `sleep(30)` çš„å€¼ï¼š
- `sleep(10)` = 10ç§’æ£€æŸ¥ä¸€æ¬¡
- `sleep(60)` = 60ç§’æ£€æŸ¥ä¸€æ¬¡
- å»ºè®®ä¸è¦ä½äº10ç§’ï¼Œé¿å…APIè¯·æ±‚è¿‡äºé¢‘ç¹

### Q6: å¦‚ä½•åªç›‘å¬ USDT è½¬è´¦ï¼Ÿ

**A:** ç›®å‰ç¨‹åºåªç›‘å¬ TRX è½¬è´¦ã€‚å¦‚éœ€ç›‘å¬ USDT-TRC20 è½¬è´¦ï¼Œéœ€è¦ä¿®æ”¹ï¼š
1. `isTrxTransfer()` æ–¹æ³•ï¼Œæ”¹ä¸ºæ£€æµ‹ TRC20 åˆçº¦è°ƒç”¨
2. `getTransactionAmount()` æ–¹æ³•ï¼Œæ”¹ä¸ºè§£æ TRC20 ä»£å¸é‡‘é¢
3. è¿™éœ€è¦æ›´æ·±å…¥çš„ TRON åŒºå—é“¾çŸ¥è¯†

### Q7: ç¨‹åºå ç”¨èµ„æºå¤šå—ï¼Ÿ

**A:** éå¸¸ä½ï¼š
- CPU: å‡ ä¹ä¸º0ï¼ˆå¤§éƒ¨åˆ†æ—¶é—´åœ¨sleepï¼‰
- å†…å­˜: çº¦20-30MB
- ç½‘ç»œ: æ¯30ç§’ä»…2-3ä¸ªAPIè¯·æ±‚

---

## ğŸ”’ å®‰å…¨å»ºè®®

1. **APIå¯†é’¥ä¿æŠ¤**
   - ä¸è¦å°†APIå¯†é’¥ç¡¬ç¼–ç åœ¨ä»£ç ä¸­
   - ä½¿ç”¨ç³»ç»Ÿé…ç½®å­˜å‚¨
   - å®šæœŸæ›´æ¢APIå¯†é’¥

2. **Webhookå®‰å…¨**
   - ä½¿ç”¨HTTPSåè®®
   - éªŒè¯è¯·æ±‚ç­¾å
   - è®¾ç½®IPç™½åå•

3. **æ—¥å¿—å®‰å…¨**
   - å®šæœŸæ¸…ç†æ—§æ—¥å¿—æ–‡ä»¶
   - ä¸è¦åœ¨æ—¥å¿—ä¸­è®°å½•æ•æ„Ÿä¿¡æ¯
   - é™åˆ¶æ—¥å¿—æ–‡ä»¶è®¿é—®æƒé™

4. **ç¨‹åºæƒé™**
   - ä½¿ç”¨ä½æƒé™ç”¨æˆ·è¿è¡Œç¨‹åº
   - ä¸è¦ä½¿ç”¨rootç”¨æˆ·

---

## ğŸ“ˆ ç›‘æ§å’Œç»´æŠ¤

### å»ºè®®çš„ç›‘æ§æŒ‡æ ‡

- âœ… ç¨‹åºè¿è¡ŒçŠ¶æ€ï¼ˆæ˜¯å¦åœ¨è¿è¡Œï¼‰
- âœ… æœ€åä¸€æ¬¡æ£€æŸ¥æ—¶é—´
- âœ… ä½™é¢å˜åŒ–è¶‹åŠ¿
- âœ… äº¤æ˜“å¤„ç†æ•°é‡
- âœ… APIè¯·æ±‚å¤±è´¥æ¬¡æ•°

### ç»´æŠ¤å»ºè®®

- æ¯å‘¨æ£€æŸ¥ä¸€æ¬¡æ—¥å¿—æ–‡ä»¶
- æ¯æœˆæ¸…ç†ä¸€æ¬¡æ—§çš„äº¤æ˜“æ—¥å¿—
- å®šæœŸå¤‡ä»½é‡è¦çš„äº¤æ˜“è®°å½•
- ç›‘æ§ç£ç›˜ç©ºé—´ä½¿ç”¨

---

## ğŸ†˜ æ•…éšœæ’æŸ¥

### ç¨‹åºæ— æ³•å¯åŠ¨

```bash
# æ£€æŸ¥PHPç¯å¢ƒ
php -v

# æ£€æŸ¥æ‰©å±•
php -m | grep -E "curl|json|redis"

# æµ‹è¯•Redisè¿æ¥
php artisan tinker
>>> Redis::ping()

# æ£€æŸ¥é…ç½®
php artisan config:cache
php artisan cache:clear
```

### APIè¯·æ±‚å¤±è´¥

```bash
# æµ‹è¯•APIè¿æ¥
curl -H "TRON-PRO-API-KEY: your-api-key" \
     "https://apilist.tronscanapi.com/api/account?address=TXXXXxxxx..."
```

### æŸ¥çœ‹è¯¦ç»†é”™è¯¯

```bash
# å¼€å¯è°ƒè¯•æ¨¡å¼
# ä¿®æ”¹ .env æ–‡ä»¶
APP_DEBUG=true

# é‡å¯ç¨‹åº
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹æœ¬æ–‡æ¡£
2. æ£€æŸ¥æ—¥å¿—æ–‡ä»¶
3. æŸ¥çœ‹ Laravel æ—¥å¿—
4. è”ç³»å¼€å‘å›¢é˜Ÿ

---

**å¼€å‘å›¢é˜Ÿ** | **æœ€åæ›´æ–°ï¼š2025-01-01** | **ç‰ˆæœ¬ï¼šv2.0**

